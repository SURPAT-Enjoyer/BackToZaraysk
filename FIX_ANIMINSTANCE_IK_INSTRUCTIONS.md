# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú –ò–ö –í ANIMINSTANCE

## –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–¥–µ:

### ‚úÖ **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ò–ö –≤ AnimInstance**
- **–ë—ã–ª–æ:** `VisibleAnywhere, Transient` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å
- **–°—Ç–∞–ª–æ:** `BlueprintReadOnly` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Animation Blueprint
- **–î–æ–±–∞–≤–ª–µ–Ω—ã:** `LeftFootIKAlpha` –∏ `RightFootIKAlpha` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–∏–ª—ã –ò–ö

### ‚úÖ **2. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –ò–ö**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (`FMath::IsFinite`)
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∏–ª—ã –ò–ö –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- –ò–ö –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤–æ–∑–¥—É—Ö–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

### ‚úÖ **3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö**
- –£–±—Ä–∞–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –º–µ–∂–¥—É –±–∞–∑–æ–≤—ã–º –∫–ª–∞—Å—Å–æ–º –∏ AnimInstance
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –ò–ö

## üö® –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã –≤ Animation Blueprint:

### **1. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ò–ö**
Animation Blueprint –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- `LeftFootEffectorLocation` (Vector)
- `RightFootEffectorLocation` (Vector)
- `LeftFootIKAlpha` (Float)
- `RightFootIKAlpha` (Float)

### **2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ò–ö –Ω–æ–¥—ã**
–í AnimGraph –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- `LeftFootIK` (TwoBoneIK –Ω–æ–¥)
- `RightFootIK` (TwoBoneIK –Ω–æ–¥)

### **3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
–ò–ö –Ω–æ–¥—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã:
- EffectorLocation ‚Üí –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ EffectorLocation
- Alpha ‚Üí –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ IKAlpha
- –í—ã—Ö–æ–¥ –ò–ö ‚Üí –æ—Å–Ω–æ–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π –≥—Ä–∞—Ñ

## üîß –†–ï–®–ï–ù–ò–ï:

### **–®–∞–≥ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ Python —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ (Ctrl+Shift+P):
```python
exec(open('Content/Python/FixAnimInstanceIK.py').read())
```

### **–®–∞–≥ 2: –†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Animation Blueprint**

#### **2.1. –û—Ç–∫—Ä–æ–π—Ç–µ ABP_Player**
- –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª –≤ Content Browser
- –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è

#### **2.2. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ò–ö**
–í **My Blueprint** ‚Üí **Variables**:
1. `LeftFootEffectorLocation` (Vector, Default: 0,0,0)
2. `RightFootEffectorLocation` (Vector, Default: 0,0,0)
3. `LeftFootIKAlpha` (Float, Default: 1.0)
4. `RightFootIKAlpha` (Float, Default: 1.0)

#### **2.3. –î–æ–±–∞–≤—å—Ç–µ –ò–ö –Ω–æ–¥—ã**
–í **AnimGraph**:
1. –î–æ–±–∞–≤—å—Ç–µ `LeftFootIK` (TwoBoneIK)
2. –î–æ–±–∞–≤—å—Ç–µ `RightFootIK` (TwoBoneIK)

#### **2.4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ò–ö –Ω–æ–¥—ã**
**LeftFootIK:**
- IKBone: `foot_l`
- Joint Target: `calf_l`
- Effector Target: `thigh_l`
- Effector Location: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `LeftFootEffectorLocation`
- Alpha: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `LeftFootIKAlpha`

**RightFootIK:**
- IKBone: `foot_r`
- Joint Target: `calf_r`
- Effector Target: `thigh_r`
- Effector Location: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `RightFootEffectorLocation`
- Alpha: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ `RightFootIKAlpha`

#### **2.5. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ò–ö –∫ –∞–Ω–∏–º–∞—Ü–∏–∏**
- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤—ã—Ö–æ–¥—ã –ò–ö –Ω–æ–¥–æ–≤ –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–º—É –≥—Ä–∞—Ñ—É
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –≤—ã—Ö–æ–¥–Ω–æ–π –Ω–æ–¥ (Output Pose)

#### **2.6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª–∞—Å—Å AnimInstance**
–í **Class Settings**:
- Parent Class: `UBTZBaseCharacterAnimInstance`

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ **–ù–æ–≥–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –±—É–¥—É—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –Ω–µ—Ä–æ–≤–Ω–æ—Å—Ç—è–º**
- ‚úÖ **–ò–ö –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–µ–º–ª–µ**
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏—è –±—É–¥–µ—Ç –ø–ª–∞–≤–Ω–æ–π –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π**
- ‚úÖ **–í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ò–ö**

## üìä –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

–í –∏–≥—Ä–µ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:
- `"IK Final - Left: X.XX, Right: X.XX"` - –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ C++ –∫–æ–¥–∞
- `"AnimInstance IK - Left: X.XX (Alpha: X.XX), Right: X.XX (Alpha: X.XX)"` - –∑–Ω–∞—á–µ–Ω–∏—è –≤ AnimInstance

## üö® –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∫–µ—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `foot_l` –∏ `foot_r`
2. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ—Å—Ç–µ–π** - `thigh_l/calf_l/foot_l` –∏ `thigh_r/calf_r/foot_r`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** - –≤—Å–µ –ø–∏–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã
4. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ AnimInstance**

## üîß –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ–Ω—Å–æ–ª–∏ Python:
```python
exec(open('Content/Python/FixAnimInstanceIK.py').read())
```

–ò —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ!
